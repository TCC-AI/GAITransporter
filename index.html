<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAIå„ªåŒ–é‹å‹™äººå“¡èª¿æ´¾å»ºè­°ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 24px;
            font-weight: 600;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .nav-tab {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-tab:hover, .nav-tab.active {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Dashboard Styles */
        .dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
        }

        .kpi-value {
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .kpi-label {
            color: #7f8c8d;
            font-size: 14px;
        }

        .alert-panel {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .alert-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .alert-icon {
            margin-right: 10px;
            color: #e74c3c;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 15px 25px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(238, 90, 82, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(238, 90, 82, 0.4);
        }

        .action-btn.secondary {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            box-shadow: 0 4px 15px rgba(68, 160, 141, 0.3);
        }

        .action-btn.secondary:hover {
            box-shadow: 0 8px 25px rgba(68, 160, 141, 0.4);
        }

        /* Schedule Board Styles */
        .schedule-board {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .filter-select {
            padding: 10px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .filter-select:focus {
            outline: none;
            border-color: #3498db;
        }

        .view-switcher {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .view-btn {
            padding: 10px 20px;
            background: #ecf0f1;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: #3498db;
            color: white;
        }

        .kanban-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            min-height: 500px;
        }

        .kanban-column {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px dashed #dee2e6;
        }

        .column-header {
            font-weight: 600;
            margin-bottom: 15px;
            color: #495057;
            text-align: center;
        }

        .task-card {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            cursor: grab;
            transition: all 0.3s ease;
        }

        .task-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .task-card:active {
            cursor: grabbing;
        }

        .task-id {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .task-customer {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .task-priority {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .priority-p {
            background: #e74c3c;
            color: white;
        }

        .priority-q {
            background: #f39c12;
            color: white;
        }

        .priority-r {
            background: #27ae60;
            color: white;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .form-input {
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #3498db;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .data-table th {
            background: #34495e;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-assigned {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-progress {
            background: #d4edda;
            color: #155724;
        }

        .status-completed {
            background: #f8d7da;
            color: #721c24;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-msg {
            background: #d4edda;
            color: #155724;
            padding: 10px 15px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #c3e6cb;
        }

        .error-msg {
            background: #f8d7da;
            color: #721c24;
            padding: 10px 15px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .kpi-grid {
                grid-template-columns: 1fr;
            }

            .filters {
                grid-template-columns: 1fr;
            }

            .kanban-board {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš› GAIå„ªåŒ–é‹å‹™äººå“¡èª¿æ´¾å»ºè­°ç³»çµ±</h1>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('dashboard')">ä¸»æ§å°</button>
                <button class="nav-tab" onclick="showTab('schedule')">ç•¶æ—¥èª¿åº¦ç›¤</button>
                <button class="nav-tab" onclick="showTab('tasks')">ä»»å‹™ç®¡ç†</button>
                <button class="nav-tab" onclick="showTab('drivers')">å¸æ©Ÿç®¡ç†</button>
                <button class="nav-tab" onclick="showTab('vehicles')">è»Šè¼›ç®¡ç†</button>
                <button class="nav-tab" onclick="showTab('settings')">ç³»çµ±è¨­å®š</button>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard">
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-value" id="totalTasks">0</div>
                        <div class="kpi-label">ä»Šæ—¥ä»»å‹™ç¸½æ•¸</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-value" id="assignedRate">0%</div>
                        <div class="kpi-label">å·²æŒ‡æ´¾ç‡</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-value" id="onlineVehicles">0</div>
                        <div class="kpi-label">å·²ä¸Šç·šè»Šæ•¸</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-value" id="priorityP">0</div>
                        <div class="kpi-label">Pç´šä»»å‹™</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-value" id="priorityQ">0</div>
                        <div class="kpi-label">Qç´šä»»å‹™</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-value" id="priorityR">0</div>
                        <div class="kpi-label">Rç´šä»»å‹™</div>
                    </div>
                </div>

                <div class="alert-panel">
                    <h3>âš ï¸ å‘Šè­¦å€</h3>
                    <div id="alertList">
                        <div class="alert-item">
                            <span class="alert-icon">ğŸš¨</span>
                            <span>å°šç„¡å‘Šè­¦è¨Šæ¯</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="quick-actions">
                <button class="action-btn" onclick="autoAssign('top1')">
                    ğŸ¯ ä¸€éµç”¢ç”Ÿå»ºè­°æ´¾é£
                </button>
                <button class="action-btn secondary" onclick="autoAssign('top3')">
                    ğŸ“‹ ç”¢ç”Ÿ Top-3 å»ºè­°
                </button>
                <button class="action-btn" onclick="checkConflicts()">
                    âš¡ è¡çªæª¢æŸ¥
                </button>
                <button class="action-btn secondary" onclick="publishToApp()">
                    ğŸ“± å…¨éƒ¨ç™¼ä½ˆåˆ°å¸æ©ŸAPP
                </button>
            </div>
        </div>

        <!-- Schedule Board Tab -->
        <div id="schedule" class="tab-content">
            <div class="schedule-board">
                <h3>ğŸ“… ç•¶æ—¥èª¿åº¦ç›¤</h3>
                
                <div class="filters">
                    <div class="filter-group">
                        <label class="filter-label">æ—¥æœŸ</label>
                        <input type="date" class="filter-select" id="filterDate">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">å®¢æˆ¶ç­‰ç´š</label>
                        <select class="filter-select" id="filterPriority">
                            <option value="">å…¨éƒ¨</option>
                            <option value="P">Pç´š</option>
                            <option value="Q">Qç´š</option>
                            <option value="R">Rç´š</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">è»Šé¡</label>
                        <select class="filter-select" id="filterVehicle">
                            <option value="">å…¨éƒ¨</option>
                            <option value="ç”²">ç”²é¡</option>
                            <option value="ä¹™">ä¹™é¡</option>
                            <option value="ä¸™">ä¸™é¡</option>
                            <option value="ä¸">ä¸é¡</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">ç‹€æ…‹</label>
                        <select class="filter-select" id="filterStatus">
                            <option value="">å…¨éƒ¨</option>
                            <option value="å¾…æ´¾">å¾…æ´¾</option>
                            <option value="å·²æ´¾">å·²æ´¾</option>
                            <option value="é€²è¡Œ">é€²è¡Œä¸­</option>
                            <option value="å®Œæˆ">å®Œæˆ</option>
                        </select>
                    </div>
                </div>

                <div class="view-switcher">
                    <button class="view-btn active" onclick="switchView('kanban')">çœ‹æ¿</button>
                    <button class="view-btn" onclick="switchView('gantt')">ç”˜ç‰¹åœ–</button>
                    <button class="view-btn" onclick="switchView('map')">åœ°åœ–</button>
                </div>

                <div id="kanbanView" class="kanban-board">
                    <div class="kanban-column" ondrop="drop(event)" ondragover="allowDrop(event)">
                        <h4 class="column-header">ğŸ“‹ ä»»å‹™æ± </h4>
                        <div id="taskPool"></div>
                    </div>
                    <div class="kanban-column" ondrop="drop(event)" ondragover="allowDrop(event)">
                        <h4 class="column-header">ğŸš› è»Šè¼›</h4>
                        <div id="vehiclePool"></div>
                    </div>
                    <div class="kanban-column" ondrop="drop(event)" ondragover="allowDrop(event)">
                        <h4 class="column-header">ğŸ‘¨â€ğŸ’¼ å¸æ©Ÿ</h4>
                        <div id="driverPool"></div>
                    </div>
                </div>

                <div id="ganttView" style="display: none;">
                    <p>ç”˜ç‰¹åœ–è¦–åœ–é–‹ç™¼ä¸­...</p>
                </div>

                <div id="mapView" style="display: none;">
                    <p>åœ°åœ–è¦–åœ–é–‹ç™¼ä¸­...</p>
                </div>
            </div>
        </div>

        <!-- Tasks Management Tab -->
        <div id="tasks" class="tab-content">
            <div class="schedule-board">
                <h3>ğŸ“¦ ä»»å‹™ç®¡ç†</h3>
                
                <div class="quick-actions" style="margin-bottom: 20px;">
                    <button class="action-btn" onclick="importFromSheet()">
                        ğŸ“¥ å¾ Google Sheet åŒ¯å…¥
                    </button>
                    <button class="action-btn secondary" onclick="showTaskForm()">
                        â• æ–°å¢ä»»å‹™
                    </button>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>é…é€å–®è™Ÿ</th>
                            <th>å®¢æˆ¶ç°¡ç¨±</th>
                            <th>é…é€æ—¥æœŸ</th>
                            <th>å®¢æˆ¶ç­‰ç´š</th>
                            <th>é…é€ç‹€æ…‹</th>
                            <th>æŒ‡æ´¾è»Šè¼›</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="tasksTableBody">
                        <!-- ä»»å‹™è³‡æ–™å°‡åœ¨æ­¤é¡¯ç¤º -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Drivers Management Tab -->
        <div id="drivers" class="tab-content">
            <div class="schedule-board">
                <h3>ğŸ‘¨â€ğŸ’¼ å¸æ©Ÿç®¡ç†</h3>
                
                <div class="quick-actions" style="margin-bottom: 20px;">
                    <button class="action-btn" onclick="showDriverForm()">
                        â• æ–°å¢å¸æ©Ÿ
                    </button>
                    <button class="action-btn secondary" onclick="checkDriverCertificates()">
                        ğŸ“‹ æª¢æŸ¥è­‰ç…§åˆ°æœŸ
                    </button>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>å§“å</th>
                            <th>å“¡å·¥ç·¨è™Ÿ</th>
                            <th>ç­‰ç´š</th>
                            <th>æ‰€å±¬</th>
                            <th>ç‹€æ…‹</th>
                            <th>æº–é»ç‡</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="driversTableBody">
                        <!-- å¸æ©Ÿè³‡æ–™å°‡åœ¨æ­¤é¡¯ç¤º -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Vehicles Management Tab -->
        <div id="vehicles" class="tab-content">
            <div class="schedule-board">
                <h3>ğŸš› è»Šè¼›ç®¡ç†</h3>
                
                <div class="quick-actions" style="margin-bottom: 20px;">
                    <button class="action-btn" onclick="showVehicleForm()">
                        â• æ–°å¢è»Šè¼›
                    </button>
                    <button class="action-btn secondary" onclick="checkVehicleInspection()">
                        ğŸ”§ æª¢æŸ¥å¹´æª¢ä¿éšª
                    </button>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>è»Šè™Ÿ</th>
                            <th>è»Šé¡</th>
                            <th>æº«å±¤èƒ½åŠ›</th>
                            <th>è¼‰é‡(å™¸)</th>
                            <th>æ¿ä½</th>
                            <th>ç‹€æ…‹</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="vehiclesTableBody">
                        <!-- è»Šè¼›è³‡æ–™å°‡åœ¨æ­¤é¡¯ç¤º -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="schedule-board">
                <h3>âš™ï¸ ç³»çµ±è¨­å®š</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Google Sheet ID</label>
                        <input type="text" class="form-input" id="sheetId" value="1imMGGvAaNjlYpQ1CS63DWSewFQrmaTt3hNQAdrRUBjs">
                    </div>
                    <div class="form-group">
                        <label class="form-label">å·¥ä½œè¡¨åç¨±</label>
                        <input type="text" class="form-input" id="sheetName" value="é…é€ä»»å‹™">
                    </div>
                </div>

                <h4>é…å°è¦å‰‡è¨­å®š</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">æº–é»æ¬Šé‡ (%)</label>
                        <input type="range" min="0" max="100" value="40" id="punctualityWeight" oninput="updateWeightDisplay()">
                        <span id="punctualityDisplay">40%</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æˆæœ¬æ¬Šé‡ (%)</label>
                        <input type="range" min="0" max="100" value="25" id="costWeight" oninput="updateWeightDisplay()">
                        <span id="costDisplay">25%</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">åŠ ç­æ¬Šé‡ (%)</label>
                        <input type="range" min="0" max="100" value="15" id="overtimeWeight" oninput="updateWeightDisplay()">
                        <span id="overtimeDisplay">15%</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å…¬å¹³æ€§æ¬Šé‡ (%)</label>
                        <input type="range" min="0" max="100" value="20" id="fairnessWeight" oninput="updateWeightDisplay()">
                        <span id="fairnessDisplay">20%</span>
                    </div>
                </div>

                <button class="action-btn" onclick="saveSettings()">ğŸ’¾ å„²å­˜è¨­å®š</button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal('taskModal')">&times;</button>
            <h3>ä»»å‹™è©³æƒ…</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">é…é€å–®è™Ÿ</label>
                    <input type="text" class="form-input" id="taskId">
                </div>
                <div class="form-group">
                    <label class="form-label">å®¢æˆ¶ç°¡ç¨±</label>
                    <input type="text" class="form-input" id="customerName">
                </div>
                <div class="form-group">
                    <label class="form-label">é…é€æ—¥æœŸ</label>
                    <input type="date" class="form-input" id="deliveryDate">
                </div>
                <div class="form-group">
                    <label class="form-label">å®¢æˆ¶ç­‰ç´š</label>
                    <select class="form-input" id="customerLevel">
                        <option value="P">Pç´š</option>
                        <option value="Q">Qç´š</option>
                        <option value="R">Rç´š</option>
                    </select>
                </div>
            </div>
            <button class="action-btn" onclick="saveTask()">ğŸ’¾ å„²å­˜</button>
        </div>
    </div>

    <div id="driverModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal('driverModal')">&times;</button>
            <h3>å¸æ©Ÿè³‡æ–™</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">å§“å</label>
                    <input type="text" class="form-input" id="driverName">
                </div>
                <div class="form-group">
                    <label class="form-label">å“¡å·¥ç·¨è™Ÿ</label>
                    <input type="text" class="form-input" id="driverCode">
                </div>
                <div class="form-group">
                    <label class="form-label">å¸æ©Ÿç­‰ç´š</label>
                    <select class="form-input" id="driverLevel">
                        <option value="A">Aç´š</option>
                        <option value="B">Bç´š</option>
                        <option value="C">Cç´š</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">æ‰€å±¬</label>
                    <select class="form-input" id="driverType">
                        <option value="è‡ªæœ‰">è‡ªæœ‰</option>
                        <option value="åŠ ç›Ÿ">åŠ ç›Ÿ</option>
                    </select>
                </div>
            </div>
            <button class="action-btn" onclick="saveDriver()">ğŸ’¾ å„²å­˜</button>
        </div>
    </div>

    <div id="vehicleModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal('vehicleModal')">&times;</button>
            <h3>è»Šè¼›è³‡æ–™</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">è»Šè™Ÿ</label>
                    <input type="text" class="form-input" id="vehicleNumber">
                </div>
                <div class="form-group">
                    <label class="form-label">è»Šé¡</label>
                    <select class="form-input" id="vehicleType">
                        <option value="ç”²">ç”²é¡</option>
                        <option value="ä¹™">ä¹™é¡</option>
                        <option value="ä¸™">ä¸™é¡</option>
                        <option value="ä¸">ä¸é¡</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">è¼‰é‡(å™¸)</label>
                    <input type="number" class="form-input" id="vehicleCapacity">
                </div>
                <div class="form-group">
                    <label class="form-label">æ¿ä½</label>
                    <input type="number" class="form-input" id="vehiclePallets">
                </div>
            </div>
            <button class="action-btn" onclick="saveVehicle()">ğŸ’¾ å„²å­˜</button>
        </div>
    </div>

    <div id="loadingModal" class="modal">
        <div class="modal-content">
            <div class="loading">
                <div class="spinner"></div>
                <p>æ­£åœ¨è™•ç†ä¸­...</p>
            </div>
        </div>
    </div>

    <script>
        // Google Apps Script URL (è«‹æ›¿æ›ç‚ºæ‚¨çš„å¯¦éš›éƒ¨ç½²URL)
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbzqcMcgLXeNzeqNQMvKNWoOHhzF_PLIrnMTJl7khtIDijdC0VB9eU9jJaJgaiPAn4Yu3Q/exec';
        
        // å…¨åŸŸè®Šæ•¸
        let currentData = {
            tasks: [],
            drivers: [],
            vehicles: [],
            assignments: []
        };

        // åˆå§‹åŒ–ç³»çµ±
        document.addEventListener('DOMContentLoaded', function() {
            initializeSystem();
            setTodayDate();
        });

        function initializeSystem() {
            loadDashboardData();
            loadTasksData();
            loadDriversData();
            loadVehiclesData();
        }

        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('filterDate').value = today;
        }

        // æ¨™ç±¤åˆ‡æ›
        function showTab(tabName) {
            // éš±è—æ‰€æœ‰æ¨™ç±¤å…§å®¹
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active ç‹€æ…‹
            const buttons = document.querySelectorAll('.nav-tab');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // é¡¯ç¤ºé¸ä¸­çš„æ¨™ç±¤
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // è¼‰å…¥å„€è¡¨æ¿è³‡æ–™
        async function loadDashboardData() {
            try {
                showLoading();
                
                const response = await callGAS('getDashboardData');
                
                if (response && response.success) {
                    updateKPIs(response.data);
                    updateAlerts(response.alerts);
                } else {
                    console.error('è¼‰å…¥å„€è¡¨æ¿è³‡æ–™å¤±æ•—:', response?.error);
                    showMessage('è¼‰å…¥å„€è¡¨æ¿è³‡æ–™å¤±æ•—', 'error');
                }
                
                hideLoading();
            } catch (error) {
                console.error('è¼‰å…¥å„€è¡¨æ¿è³‡æ–™å¤±æ•—:', error);
                showMessage('è¼‰å…¥å„€è¡¨æ¿è³‡æ–™å¤±æ•—: ' + error.message, 'error');
                hideLoading();
            }
        }

        function updateKPIs(data) {
            document.getElementById('totalTasks').textContent = data.totalTasks || 0;
            document.getElementById('assignedRate').textContent = (data.assignedRate || 0) + '%';
            document.getElementById('onlineVehicles').textContent = data.onlineVehicles || 0;
            document.getElementById('priorityP').textContent = data.priorityP || 0;
            document.getElementById('priorityQ').textContent = data.priorityQ || 0;
            document.getElementById('priorityR').textContent = data.priorityR || 0;
        }

        function updateAlerts(alerts) {
            const alertList = document.getElementById('alertList');
            if (alerts && alerts.length > 0) {
                alertList.innerHTML = alerts.map(alert => `
                    <div class="alert-item">
                        <span class="alert-icon">ğŸš¨</span>
                        <span>${alert}</span>
                    </div>
                `).join('');
            }
        }

        // è¼‰å…¥ä»»å‹™è³‡æ–™
        async function loadTasksData() {
            try {
                const response = await callGAS('getTasks');
                
                if (response && response.success) {
                    currentData.tasks = response.data;
                    updateTasksTable();
                    updateKanbanBoard();
                } else {
                    console.error('è¼‰å…¥ä»»å‹™è³‡æ–™å¤±æ•—:', response?.error);
                    showMessage('è¼‰å…¥ä»»å‹™è³‡æ–™å¤±æ•—', 'error');
                }
            } catch (error) {
                console.error('è¼‰å…¥ä»»å‹™è³‡æ–™å¤±æ•—:', error);
                showMessage('è¼‰å…¥ä»»å‹™è³‡æ–™å¤±æ•—: ' + error.message, 'error');
            }
        }

        function generateSampleTasks() {
            return [
                {
                    id: 'T001',
                    customerName: 'å…¨è¯ç¦åˆ©ä¸­å¿ƒ',
                    deliveryDate: new Date().toISOString().split('T')[0],
                    priority: 'P',
                    status: 'å¾…æ´¾',
                    vehicle: '',
                    driver: ''
                },
                {
                    id: 'T002',
                    customerName: 'å®¶æ¨‚ç¦',
                    deliveryDate: new Date().toISOString().split('T')[0],
                    priority: 'Q',
                    status: 'å·²æ´¾',
                    vehicle: 'ç”²001',
                    driver: 'å¼µä¸‰'
                },
                {
                    id: 'T003',
                    customerName: 'å¥½å¸‚å¤š',
                    deliveryDate: new Date().toISOString().split('T')[0],
                    priority: 'R',
                    status: 'é€²è¡Œä¸­',
                    vehicle: 'ä¹™002',
                    driver: 'æå››'
                }
            ];
        }

        function updateTasksTable() {
            const tbody = document.getElementById('tasksTableBody');
            tbody.innerHTML = currentData.tasks.map(task => `
                <tr>
                    <td>${task.id}</td>
                    <td>${task.customerName}</td>
                    <td>${task.deliveryDate}</td>
                    <td><span class="task-priority priority-${task.priority.toLowerCase()}">${task.priority}</span></td>
                    <td><span class="status-badge status-${getStatusClass(task.status)}">${task.status}</span></td>
                    <td>${task.vehicle || '-'}</td>
                    <td>
                        <button class="action-btn" style="padding: 5px 10px; font-size: 12px;" onclick="editTask('${task.id}')">ç·¨è¼¯</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateKanbanBoard() {
            const taskPool = document.getElementById('taskPool');
            const vehiclePool = document.getElementById('vehiclePool');
            const driverPool = document.getElementById('driverPool');

            // æ›´æ–°ä»»å‹™æ± 
            taskPool.innerHTML = currentData.tasks.filter(task => task.status === 'å¾…æ´¾').map(task => `
                <div class="task-card" draggable="true" ondragstart="drag(event)" data-id="${task.id}">
                    <div class="task-id">${task.id}</div>
                    <div class="task-customer">${task.customerName}</div>
                    <span class="task-priority priority-${task.priority.toLowerCase()}">${task.priority}</span>
                </div>
            `).join('');

            // æ›´æ–°è»Šè¼›æ± 
            vehiclePool.innerHTML = currentData.vehicles.map(vehicle => `
                <div class="task-card" draggable="true" ondragstart="drag(event)" data-id="${vehicle.number}">
                    <div class="task-id">${vehicle.number}</div>
                    <div class="task-customer">${vehicle.type}é¡è»Š</div>
                </div>
            `).join('');

            // æ›´æ–°å¸æ©Ÿæ± 
            driverPool.innerHTML = currentData.drivers.map(driver => `
                <div class="task-card" draggable="true" ondragstart="drag(event)" data-id="${driver.code}">
                    <div class="task-id">${driver.name}</div>
                    <div class="task-customer">${driver.level}ç´šå¸æ©Ÿ</div>
                </div>
            `).join('');
        }

        // è¼‰å…¥å¸æ©Ÿè³‡æ–™
        async function loadDriversData() {
            try {
                const response = await callGAS('getDrivers');
                
                if (response && response.success) {
                    currentData.drivers = response.data;
                } else {
                    console.error('è¼‰å…¥å¸æ©Ÿè³‡æ–™å¤±æ•—:', response?.error);
                    showMessage('è¼‰å…¥å¸æ©Ÿè³‡æ–™å¤±æ•—', 'error');
                }
                updateDriversTable();
            } catch (error) {
                console.error('è¼‰å…¥å¸æ©Ÿè³‡æ–™å¤±æ•—:', error);
                showMessage('è¼‰å…¥å¸æ©Ÿè³‡æ–™å¤±æ•—: ' + error.message, 'error');
                updateDriversTable();
            }
        }

        function generateSampleDrivers() {
            return [
                {
                    name: 'å¼µä¸‰',
                    code: 'D001',
                    level: 'A',
                    type: 'è‡ªæœ‰',
                    status: 'å¯æ´¾',
                    punctuality: 95
                },
                {
                    name: 'æå››',
                    code: 'D002',
                    level: 'B',
                    type: 'åŠ ç›Ÿ',
                    status: 'å‡ºå‹¤ä¸­',
                    punctuality: 88
                },
                {
                    name: 'ç‹äº”',
                    code: 'D003',
                    level: 'C',
                    type: 'è‡ªæœ‰',
                    status: 'å¯æ´¾',
                    punctuality: 92
                }
            ];
        }

        function updateDriversTable() {
            const tbody = document.getElementById('driversTableBody');
            tbody.innerHTML = currentData.drivers.map(driver => `
                <tr>
                    <td>${driver.name}</td>
                    <td>${driver.code}</td>
                    <td>${driver.level}</td>
                    <td>${driver.type}</td>
                    <td><span class="status-badge status-${getStatusClass(driver.status)}">${driver.status}</span></td>
                    <td>${driver.punctuality}%</td>
                    <td>
                        <button class="action-btn" style="padding: 5px 10px; font-size: 12px;" onclick="editDriver('${driver.code}')">ç·¨è¼¯</button>
                    </td>
                </tr>
            `).join('');
        }

        // è¼‰å…¥è»Šè¼›è³‡æ–™
        async function loadVehiclesData() {
            try {
                const response = await callGAS('getVehicles');
                
                if (response && response.success) {
                    currentData.vehicles = response.data;
                } else {
                    console.error('è¼‰å…¥è»Šè¼›è³‡æ–™å¤±æ•—:', response?.error);
                    showMessage('è¼‰å…¥è»Šè¼›è³‡æ–™å¤±æ•—', 'error');
                }
                updateVehiclesTable();
            } catch (error) {
                console.error('è¼‰å…¥è»Šè¼›è³‡æ–™å¤±æ•—:', error);
                showMessage('è¼‰å…¥è»Šè¼›è³‡æ–™å¤±æ•—: ' + error.message, 'error');
                updateVehiclesTable();
            }
        }

        function generateSampleVehicles() {
            return [
                {
                    number: 'ç”²001',
                    type: 'ç”²',
                    temperature: 'å†·å‡/å†·è—',
                    capacity: 15,
                    pallets: 20,
                    status: 'å¯ç”¨'
                },
                {
                    number: 'ä¹™002',
                    type: 'ä¹™',
                    temperature: 'å†·è—',
                    capacity: 10,
                    pallets: 15,
                    status: 'èª¿åº¦ä¸­'
                },
                {
                    number: 'ä¸™003',
                    type: 'ä¸™',
                    temperature: 'å¸¸æº«',
                    capacity: 8,
                    pallets: 12,
                    status: 'å¯ç”¨'
                }
            ];
        }

        function updateVehiclesTable() {
            const tbody = document.getElementById('vehiclesTableBody');
            tbody.innerHTML = currentData.vehicles.map(vehicle => `
                <tr>
                    <td>${vehicle.number}</td>
                    <td>${vehicle.type}</td>
                    <td>${vehicle.temperature}</td>
                    <td>${vehicle.capacity}</td>
                    <td>${vehicle.pallets}</td>
                    <td><span class="status-badge status-${getStatusClass(vehicle.status)}">${vehicle.status}</span></td>
                    <td>
                        <button class="action-btn" style="padding: 5px 10px; font-size: 12px;" onclick="editVehicle('${vehicle.number}')">ç·¨è¼¯</button>
                    </td>
                </tr>
            `).join('');
        }

        // å·¥å…·å‡½æ•¸
        function getStatusClass(status) {
            const statusMap = {
                'å¾…æ´¾': 'pending',
                'å·²æ´¾': 'assigned',
                'é€²è¡Œä¸­': 'progress',
                'å‡ºå‹¤ä¸­': 'progress',
                'å®Œæˆ': 'completed',
                'å¯æ´¾': 'assigned',
                'å¯ç”¨': 'assigned',
                'èª¿åº¦ä¸­': 'progress',
                'ä¿é¤Š': 'completed'
            };
            return statusMap[status] || 'pending';
        }

        // Google Apps Script å‘¼å« - ä½¿ç”¨ JSONP å®Œå…¨é¿å… CORS
        async function callGAS(action, data = {}) {
            return new Promise((resolve, reject) => {
                // å»ºç«‹å”¯ä¸€çš„å›èª¿å‡½æ•¸åç¨±
                const callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());
                
                // è¨­å®šå…¨åŸŸå›èª¿å‡½æ•¸
                window[callbackName] = function(response) {
                    // æ¸…ç†
                    delete window[callbackName];
                    if (document.head.contains(script)) {
                        document.head.removeChild(script);
                    }
                    resolve(response);
                };
                
                // æº–å‚™åƒæ•¸
                const params = new URLSearchParams({
                    action: action,
                    data: JSON.stringify(data),
                    callback: callbackName
                });
                
                // å»ºç«‹ script æ¨™ç±¤
                const script = document.createElement('script');
                script.src = `${GAS_URL}?${params.toString()}`;
                
                // éŒ¯èª¤è™•ç†
                script.onerror = function() {
                    delete window[callbackName];
                    if (document.head.contains(script)) {
                        document.head.removeChild(script);
                    }
                    reject(new Error('è¼‰å…¥è…³æœ¬å¤±æ•—'));
                };
                
                // è¶…æ™‚è™•ç†
                const timeout = setTimeout(() => {
                    if (window[callbackName]) {
                        delete window[callbackName];
                        if (document.head.contains(script)) {
                            document.head.removeChild(script);
                        }
                        reject(new Error('è«‹æ±‚è¶…æ™‚'));
                    }
                }, 15000); // 15ç§’è¶…æ™‚
                
                // æˆåŠŸæ™‚æ¸…é™¤è¶…æ™‚
                const originalCallback = window[callbackName];
                window[callbackName] = function(response) {
                    clearTimeout(timeout);
                    originalCallback(response);
                };
                
                // æ·»åŠ åˆ°é é¢
                document.head.appendChild(script);
            });
        }

        // è‡ªå‹•é…å°åŠŸèƒ½
        async function autoAssign(type) {
            showLoading();
            
            try {
                const response = await callGAS('autoAssign', { type: type });
                
                if (response.success) {
                    showMessage('è‡ªå‹•é…å°å®Œæˆï¼', 'success');
                    loadTasksData();
                    loadDashboardData();
                } else {
                    showMessage('è‡ªå‹•é…å°å¤±æ•—ï¼š' + (response.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
                }
            } catch (error) {
                console.error('è‡ªå‹•é…å°å¤±æ•—:', error);
                showMessage('è‡ªå‹•é…å°å¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
            
            hideLoading();
        }

        // è¡çªæª¢æŸ¥
        async function checkConflicts() {
            showLoading();
            
            try {
                const response = await callGAS('checkConflicts');
                
                if (response.success) {
                    if (response.conflicts && response.conflicts.length > 0) {
                        showMessage(`ç™¼ç¾ ${response.conflicts.length} å€‹è¡çª`, 'error');
                        updateAlerts(response.conflicts);
                    } else {
                        showMessage('æœªç™¼ç¾è¡çª', 'success');
                    }
                } else {
                    showMessage('è¡çªæª¢æŸ¥å¤±æ•—', 'error');
                }
            } catch (error) {
                console.error('è¡çªæª¢æŸ¥å¤±æ•—:', error);
                showMessage('è¡çªæª¢æŸ¥å¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
            
            hideLoading();
        }

        // ç™¼ä½ˆåˆ°APP
        async function publishToApp() {
            showLoading();
            
            try {
                const response = await callGAS('publishToApp');
                
                if (response.success) {
                    showMessage('æˆåŠŸç™¼ä½ˆåˆ°å¸æ©ŸAPP', 'success');
                } else {
                    showMessage('ç™¼ä½ˆå¤±æ•—ï¼š' + (response.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
                }
            } catch (error) {
                console.error('ç™¼ä½ˆå¤±æ•—:', error);
                showMessage('ç™¼ä½ˆå¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
            
            hideLoading();
        }

        // å¾ Google Sheet åŒ¯å…¥
        async function importFromSheet() {
            showLoading();
            
            try {
                const sheetId = document.getElementById('sheetId').value;
                const sheetName = document.getElementById('sheetName').value;
                
                const response = await callGAS('importFromSheet', {
                    sheetId: sheetId,
                    sheetName: sheetName
                });
                
                if (response.success) {
                    showMessage('åŒ¯å…¥æˆåŠŸï¼', 'success');
                    loadTasksData();
                    loadDashboardData();
                } else {
                    showMessage('åŒ¯å…¥å¤±æ•—ï¼š' + (response.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
                }
            } catch (error) {
                console.error('åŒ¯å…¥å¤±æ•—:', error);
                showMessage('åŒ¯å…¥å¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
            
            hideLoading();
        }

        // é¡¯ç¤ºè¡¨å–®
        function showTaskForm() {
            document.getElementById('taskModal').style.display = 'block';
        }

        function showDriverForm() {
            document.getElementById('driverModal').style.display = 'block';
        }

        function showVehicleForm() {
            document.getElementById('vehicleModal').style.display = 'block';
        }

        // é—œé–‰æ¨¡æ…‹æ¡†
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // å„²å­˜è³‡æ–™
        async function saveTask() {
            const taskData = {
                id: document.getElementById('taskId').value,
                customerName: document.getElementById('customerName').value,
                deliveryDate: document.getElementById('deliveryDate').value,
                priority: document.getElementById('customerLevel').value
            };
            
            try {
                const response = await callGAS('saveTask', taskData);
                
                if (response.success) {
                    showMessage('ä»»å‹™å„²å­˜æˆåŠŸï¼', 'success');
                    closeModal('taskModal');
                    loadTasksData();
                } else {
                    showMessage('å„²å­˜å¤±æ•—ï¼š' + (response.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
                }
            } catch (error) {
                console.error('å„²å­˜å¤±æ•—:', error);
                showMessage('å„²å­˜å¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
        }

        async function saveDriver() {
            const driverData = {
                name: document.getElementById('driverName').value,
                code: document.getElementById('driverCode').value,
                level: document.getElementById('driverLevel').value,
                type: document.getElementById('driverType').value
            };
            
            try {
                const response = await callGAS('saveDriver', driverData);
                
                if (response.success) {
                    showMessage('å¸æ©Ÿè³‡æ–™å„²å­˜æˆåŠŸï¼', 'success');
                    closeModal('driverModal');
                    loadDriversData();
                } else {
                    showMessage('å„²å­˜å¤±æ•—ï¼š' + (response.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
                }
            } catch (error) {
                console.error('å„²å­˜å¤±æ•—:', error);
                showMessage('å„²å­˜å¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
        }

        async function saveVehicle() {
            const vehicleData = {
                number: document.getElementById('vehicleNumber').value,
                type: document.getElementById('vehicleType').value,
                capacity: document.getElementById('vehicleCapacity').value,
                pallets: document.getElementById('vehiclePallets').value
            };
            
            try {
                const response = await callGAS('saveVehicle', vehicleData);
                
                if (response.success) {
                    showMessage('è»Šè¼›è³‡æ–™å„²å­˜æˆåŠŸï¼', 'success');
                    closeModal('vehicleModal');
                    loadVehiclesData();
                } else {
                    showMessage('å„²å­˜å¤±æ•—ï¼š' + (response.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
                }
            } catch (error) {
                console.error('å„²å­˜å¤±æ•—:', error);
                showMessage('å„²å­˜å¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
        }

        // æ‹–æ‹½åŠŸèƒ½
        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.getAttribute('data-id'));
        }

        function drop(ev) {
            ev.preventDefault();
            const data = ev.dataTransfer.getData("text");
            // é€™è£¡å¯ä»¥å¯¦ç¾æ‹–æ‹½é…å°é‚è¼¯
            console.log('Dropped:', data);
        }

        // è¦–åœ–åˆ‡æ›
        function switchView(viewType) {
            const views = ['kanban', 'gantt', 'map'];
            views.forEach(view => {
                document.getElementById(view + 'View').style.display = 'none';
            });
            
            document.getElementById(viewType + 'View').style.display = 'block';
            
            const buttons = document.querySelectorAll('.view-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // æ¬Šé‡é¡¯ç¤ºæ›´æ–°
        function updateWeightDisplay() {
            document.getElementById('punctualityDisplay').textContent = 
                document.getElementById('punctualityWeight').value + '%';
            document.getElementById('costDisplay').textContent = 
                document.getElementById('costWeight').value + '%';
            document.getElementById('overtimeDisplay').textContent = 
                document.getElementById('overtimeWeight').value + '%';
            document.getElementById('fairnessDisplay').textContent = 
                document.getElementById('fairnessWeight').value + '%';
        }

        // å„²å­˜è¨­å®š
        async function saveSettings() {
            const settings = {
                sheetId: document.getElementById('sheetId').value,
                sheetName: document.getElementById('sheetName').value,
                weights: {
                    punctuality: document.getElementById('punctualityWeight').value,
                    cost: document.getElementById('costWeight').value,
                    overtime: document.getElementById('overtimeWeight').value,
                    fairness: document.getElementById('fairnessWeight').value
                }
            };
            
            try {
                const response = await callGAS('saveSettings', settings);
                
                if (response.success) {
                    showMessage('è¨­å®šå„²å­˜æˆåŠŸï¼', 'success');
                } else {
                    showMessage('è¨­å®šå„²å­˜å¤±æ•—ï¼š' + (response.error || 'æœªçŸ¥éŒ¯èª¤'), 'error');
                }
            } catch (error) {
                console.error('è¨­å®šå„²å­˜å¤±æ•—:', error);
                showMessage('è¨­å®šå„²å­˜å¤±æ•—ï¼šç¶²è·¯éŒ¯èª¤', 'error');
            }
        }

        // è¼‰å…¥ä¸­é¡¯ç¤º
        function showLoading() {
            document.getElementById('loadingModal').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loadingModal').style.display = 'none';
        }

        // è¨Šæ¯é¡¯ç¤º
        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-msg' : 'error-msg';
            messageDiv.textContent = message;
            messageDiv.style.position = 'fixed';
            messageDiv.style.top = '20px';
            messageDiv.style.right = '20px';
            messageDiv.style.zIndex = '10000';
            messageDiv.style.minWidth = '300px';
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                document.body.removeChild(messageDiv);
            }, 3000);
        }

        // ç·¨è¼¯åŠŸèƒ½ï¼ˆplaceholderï¼‰
        function editTask(taskId) {
            console.log('ç·¨è¼¯ä»»å‹™:', taskId);
        }

        function editDriver(driverCode) {
            console.log('ç·¨è¼¯å¸æ©Ÿ:', driverCode);
        }

        function editVehicle(vehicleNumber) {
            console.log('ç·¨è¼¯è»Šè¼›:', vehicleNumber);
        }

        function checkDriverCertificates() {
            showMessage('æª¢æŸ¥è­‰ç…§åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
        }

        function checkVehicleInspection() {
            showMessage('æª¢æŸ¥å¹´æª¢åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
        }
    </script>
</body>
</html>
